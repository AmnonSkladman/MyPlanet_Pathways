<!DOCTYPE html>

<html>
<head>
<script lang="javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.11.3/xlsx.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

</head>

<body>

<input onchange="openFile(this.files)" type="file" multiple accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" ID="fileSelect" runat="server"  /> 
<img id="output"/>

</body>

<script>

var sendData = function(data) {
    $.post('http://localhost:3000/api/upload', function(data, status) {
        console.log(status)
    })
}

var openFile = function(files) {
    console.log(files)
    var numFiles = Object.keys(files).length;
    var dataFiles = []

    Object.keys(files).forEach(i => {
        var reader = new FileReader()
        reader.readAsDataURL(files[i])

        reader.onload = function(event){
            dataFiles.push(event.target.result)
            if (dataFiles.length === numFiles) {
                sendData(dataFiles)
            }
        };
    })
}

</script>
</html>
